# 교착 상태 (Deadlock)

- 프로세스는 실행을 위해 여러 자원을 필요로 한다.
  - CPU, 메모리, 파일, 프린터, ...
  - 어떤 자원은 갖고 있으나 다른 자원은 갖지 못할 때(다른 프로세스가 사용중이 라던지,,) **대기**해야한다...
  - 다른 프로세스 역시 다른 자원을 가지려고 대기할 때, **데드락** 가능성
  
- 교착 상태 필요 조건
  - Mutual Exclusion (롤이 메모리를 쓰고 있으면 스타는 메모리를 못 씀)
  - Hold and wait (롤이 CPU를 잡고 있으면서 메모리를 기다림)
  - No Preemption (롤이 메모리를 잡고 있으면 끝날 때 까지 못 뺏음)
  - Circular wait
  - 4가지 만족해야 교착 상태가 일어날 수 있다. 그래서 자주 안 일어남.

- 예제 : 식사하는 철학자 문제
  
### 자원
- 동일 자원
  - 동일 형식 자원이 여러개 있을 수 있다.
  - 동일 CPU 2개, 동일 프린터 3개...

- 자원의 사용
  - 요청 (request) -> 사용 (use) -> 반납 (release)

- 자원 할당도 (Resourse Allocation Graph)
  - 어떤 자원이 어떤 프로세스에 할당됐는가?
  - 어떤 프로세스가 어떤 자원을 할당받으려고 기다리는가?
  - 자원 : 사각형, 프로세스 : 원, 할당 : 화살표
 
 
### 교착 상태 처리
  1. 교착 상태 방지 (Deadlock Prevention) : 교착 상태 4가지 필요조건 중 한 가지 이상 불만족
  - 상호 배타 (Mutual exclusion)
    - 자원을 공유 가능하게. 원천적으로 불가할 수도...
  - 보유 및 대기 (Hold and Wait)
    - 자원을 가지고 있으면서 다른 자원을 기다리지 않게.
    - 예 : 자원이 없는 상태에서 모든 자원 댁, 일부 자원만 가용하면 보유 자원을 모두 놓아줌.
    - 단점 : 자원 활용 저하, 기아 문제. 굶어 죽을 수도...
  - 비선점 (No preemption)
    -  자원을 선정 가능하도록. 원천적 불가할 수도...(프린터 쓰고있는데 뺏어 쓰기는 좀..)
  - 환형 대기 (Circular wait)
    - 자원에 번호를 부여해 오름차순으로 자원을 요청
    - 단점 : 자원 활용 저하..
    
